@model IEnumerable<OECS.Models.ProductModels.ViewProductModel>
@using OECS.Models;
<div class="modal-header">
    <h5 class="modal-title">Gallery</h5>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
<div class="modal-body">
    <div class="container-fluid clearfix">
        <div class="gallery text-center">
            <input type="hidden" id="txtHidProductID" value="@ViewBag.ProductID" />
            <div class="previews">
                @{
                    oecsEntities dbContext = new oecsEntities();
                    int productID = Convert.ToInt32(ViewBag.ProductID);
                    var icon = dbContext.DisplayColor
                                        .Where(i => i.ProductImage.ProductDetail.ProductID == productID)
                                        .Select(i => new
                                        {
                                            i.ProductImage.Image.IconID,
                                            i.ProductImage.ProductDetail.ProductID,
                                            i.ProductImage.ProductDetail.ColorID,
                                            i.ProductImage.Image.Icon.icon1
                                        }).Distinct().ToList();

                    var defaultImg = "";
                    var isMainDisplay = "";

                    var display = Model.Where(d => d.ProductImage.DisplayColor.Count() > 0).FirstOrDefault();
                    isMainDisplay = (display.ProductImage.isMainDisplay == true ? "main-display" : "");
                    defaultImg = display.ProductImage.Image.path;
                    <a class="selected default-img @isMainDisplay" productImageID="@display.ProductImage.ProductImageID" data-full="@defaultImg">
                        <img src="@defaultImg" />
                    </a>

                    foreach (var img in Model.Where(i => i.ProductImage.DisplayColor.Count() == 0).Take(4))
                    {
                        isMainDisplay = (img.ProductImage.isMainDisplay == true ? "main-display" : "");
                        <a class="img-link-wrapper @isMainDisplay" productImageID="@img.ProductImage.ProductImageID" data-full="@img.ProductImage.Image.path">
                            <img src="@img.ProductImage.Image.path" />
                        </a>
                    }
                }
            </div>
            <div class="full">
                <img src="@defaultImg" />
            </div>
        </div>
    </div>
    <div class="container">
        @foreach (var i in icon)
        {
            <a onclick="ViewProductPhotoGallery(parseInt(@i.ProductID), parseInt(@i.ColorID), parseInt(@i.IconID))">
                <img src="@i.icon1" class="img-fluid z-depth-1 rounded-circle img-thumbnail icon" id="icon-@i.IconID">
            </a>
        }
    </div>
</div>
<div class="modal-footer">
    <div class="btn-group" role="group" aria-label="Basic example">
        <button type="button" class="btn btn-primary" id="BtnSetUsDisplay">Set Us Display</button>
        <button type="button" class="btn btn-primary" id="BtnSetUsMainDisplay">Set Us Main Display</button>
        <button type="button" class="btn btn-primary" id="BtnSetUsBothDisplay">Both</button>
    </div>
    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
</div>
